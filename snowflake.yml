version: "1.0"

# ==========================================
# Databases
# ==========================================
databases:
  # Production
    - prep:
        shared: no
    - prod:
        shared: no
    - raw:
        shared: no
    - snowflake:
        shared: yes


# ==========================================
# Roles
# ==========================================
roles:
    ## Admin Roles
    - accountadmin:
        warehouses:
            - admin
        member_of:
            - securityadmin
            - sysadmin

    - securityadmin:
        warehouses:
            - admin
        member_of:
            - useradmin

    - useradmin:
        warehouses:
            - admin

    - sysadmin:
        member_of:
          include:
            - "*"
          exclude:
            - accountadmin
            - securityadmin
            - useradmin
        warehouses:
            - admin
        privileges:
            databases:
                read:
                    - prep
                    - prod
                    - raw
                    - snowflake
                write:
                    - prep
                    - prod
                    - raw
            schemas:
                read:
                    - prep.*
                    - prod.*
                    - raw.*
                    - snowflake.*
                write:
                    - prep.*
                    - prod.*
                    - raw.*
            tables:
                read:
                    - prep.*.*
                    - prod.*.*
                    - raw.*.*
                    - snowflake.*.*
                write:
                    - prep.*.*
                    - prod.*.*
                    - raw.*.*

# ==========================================
# Functional Roles
# ==========================================

    - core:
        privileges:
            databases:
                read:
                    - prep
                    - prod
                    - raw
                    - snowflake
                write:
                    - prep
                    - prod
                    - raw
            schemas:
                read:
                    - prep.*
                    - prod.*
                    - raw.*
                    - snowflake.*
                write:
                    - prep.*
                    - prod.*
                    - raw.*
            tables:
                read:
                    - prep.*.*
                    - prod.*.*
                    - raw.*.*
                    - snowflake.*.*
                write:
                    - prep.*.*
                    - prod.*.*
                    - raw.*.*

    - loader:
        warehouses:
            - loader
        privileges:
            databases:
                read:
                    - raw
                write:
                    - raw
            schemas:
                read:
                    - raw.*
                write:
                    - raw.*
            tables:
                read:
                    - raw.*.*
                write:
                    - raw.*.*

# ==========================================
# User Roles
# ==========================================
    
    - tmurphy:
        member_of:
            - core
        warehouses:
            - core


# ==========================================
# Users
# ==========================================
users:

    - meltano_loader:
        can_login: yes
        member_of:
            - loader

    - permission_bot:
        can_login: yes
        member_of:
            - securityadmin

    - tmurphy:
        can_login: yes
        member_of:
            - tmurphy
            - accountadmin
            - securityadmin
            - useradmin
            - sysadmin

# ==========================================
# Warehouses
# ==========================================
warehouses:
    - admin:
        size: x-small

    - core:
        size: x-small

    - loader:
        size: x-small
