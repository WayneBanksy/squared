version: 2

models:
  - name: structured_executions
    description: This table includes the blended set of structured legacy Google Analytics (GA) and Snowplow data.
      Projects are compared using event counts at the week level, once they have parity for a week we switch to using Snowplow over GA.
      There are data tests that assert that the project and event counts in this table are >= that of just GA.
    columns:
      - name: event_source
        tests:
          - not_null
          - accepted_values:
              values: ['ga', 'snowplow']
      - name: event_count
        tests:
          - not_null
      - name: command_category
        tests:
          - not_null
      - name: command
        tests:
          - not_null
      - name: project_id
        tests:
          - not_null
      - name: execution_id
        tests:
          - unique
          - not_null
      - name: event_created_at
        tests:
          - not_null
      - name: event_created_date
        tests:
          - not_null

  - name: unstructured_executions
    description: This table is similar to "unstruct_exec_flattened" only that it filters out project IDs that aren't
      considered active in terms of Snowplow as its primary source of events.
    columns:
      - name: execution_id
        tests:
          - not_null
          - unique

  - name: hash_lookup
    description: This table unhashes known values like (i.e. plugin names, variants, common environment names, etc.)
      to build a lookup table to convert hashed values into unhashed values.
    columns:
      - name: hash_value
        tests:
          - not_null
          - unique
      - name: unhashed_value
        tests:
          - not_null
          - unique